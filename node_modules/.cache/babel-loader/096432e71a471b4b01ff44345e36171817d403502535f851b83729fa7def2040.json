{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/es.array.push.js\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.withTimeout = void 0;\nvar tslib_1 = require(\"tslib\");\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nfunction withTimeout(sync, timeout, timeoutError) {\n  var _this = this;\n  if (timeoutError === void 0) {\n    timeoutError = new Error('timeout');\n  }\n  return {\n    acquire: function () {\n      return new Promise(function (resolve, reject) {\n        return tslib_1.__awaiter(_this, void 0, void 0, function () {\n          var isTimeout, ticket, release;\n          return tslib_1.__generator(this, function (_a) {\n            switch (_a.label) {\n              case 0:\n                isTimeout = false;\n                setTimeout(function () {\n                  isTimeout = true;\n                  reject(timeoutError);\n                }, timeout);\n                return [4 /*yield*/, sync.acquire()];\n              case 1:\n                ticket = _a.sent();\n                if (isTimeout) {\n                  release = Array.isArray(ticket) ? ticket[1] : ticket;\n                  release();\n                } else {\n                  resolve(ticket);\n                }\n                return [2 /*return*/];\n            }\n          });\n        });\n      });\n    },\n\n    runExclusive: function (callback) {\n      return tslib_1.__awaiter(this, void 0, void 0, function () {\n        var release, ticket;\n        return tslib_1.__generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              release = function () {\n                return undefined;\n              };\n              _a.label = 1;\n            case 1:\n              _a.trys.push([1,, 7, 8]);\n              return [4 /*yield*/, this.acquire()];\n            case 2:\n              ticket = _a.sent();\n              if (!Array.isArray(ticket)) return [3 /*break*/, 4];\n              release = ticket[1];\n              return [4 /*yield*/, callback(ticket[0])];\n            case 3:\n              return [2 /*return*/, _a.sent()];\n            case 4:\n              release = ticket;\n              return [4 /*yield*/, callback()];\n            case 5:\n              return [2 /*return*/, _a.sent()];\n            case 6:\n              return [3 /*break*/, 8];\n            case 7:\n              release();\n              return [7 /*endfinally*/];\n            case 8:\n              return [2 /*return*/];\n          }\n        });\n      });\n    },\n\n    release: function () {\n      sync.release();\n    },\n    isLocked: function () {\n      return sync.isLocked();\n    }\n  };\n}\nexports.withTimeout = withTimeout;","map":{"version":3,"names":["Object","defineProperty","exports","value","withTimeout","tslib_1","require","sync","timeout","timeoutError","_this","Error","acquire","Promise","resolve","reject","__awaiter","isTimeout","ticket","release","__generator","_a","label","setTimeout","sent","Array","isArray","runExclusive","callback","undefined","trys","push","isLocked"],"sources":["/Users/shepher/Downloads/filename-space/node_modules/async-mutex/lib/withTimeout.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.withTimeout = void 0;\nvar tslib_1 = require(\"tslib\");\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nfunction withTimeout(sync, timeout, timeoutError) {\n    var _this = this;\n    if (timeoutError === void 0) { timeoutError = new Error('timeout'); }\n    return {\n        acquire: function () {\n            return new Promise(function (resolve, reject) { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n                var isTimeout, ticket, release;\n                return tslib_1.__generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            isTimeout = false;\n                            setTimeout(function () {\n                                isTimeout = true;\n                                reject(timeoutError);\n                            }, timeout);\n                            return [4 /*yield*/, sync.acquire()];\n                        case 1:\n                            ticket = _a.sent();\n                            if (isTimeout) {\n                                release = Array.isArray(ticket) ? ticket[1] : ticket;\n                                release();\n                            }\n                            else {\n                                resolve(ticket);\n                            }\n                            return [2 /*return*/];\n                    }\n                });\n            }); });\n        },\n        runExclusive: function (callback) {\n            return tslib_1.__awaiter(this, void 0, void 0, function () {\n                var release, ticket;\n                return tslib_1.__generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            release = function () { return undefined; };\n                            _a.label = 1;\n                        case 1:\n                            _a.trys.push([1, , 7, 8]);\n                            return [4 /*yield*/, this.acquire()];\n                        case 2:\n                            ticket = _a.sent();\n                            if (!Array.isArray(ticket)) return [3 /*break*/, 4];\n                            release = ticket[1];\n                            return [4 /*yield*/, callback(ticket[0])];\n                        case 3: return [2 /*return*/, _a.sent()];\n                        case 4:\n                            release = ticket;\n                            return [4 /*yield*/, callback()];\n                        case 5: return [2 /*return*/, _a.sent()];\n                        case 6: return [3 /*break*/, 8];\n                        case 7:\n                            release();\n                            return [7 /*endfinally*/];\n                        case 8: return [2 /*return*/];\n                    }\n                });\n            });\n        },\n        release: function () {\n            sync.release();\n        },\n        isLocked: function () { return sync.isLocked(); },\n    };\n}\nexports.withTimeout = withTimeout;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}