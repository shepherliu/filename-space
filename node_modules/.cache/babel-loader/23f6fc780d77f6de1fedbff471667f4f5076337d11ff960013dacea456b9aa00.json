{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/es.array.push.js\");\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n    return extendStatics(d, b);\n  };\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function () {\n        return m[k];\n      }\n    };\n  }\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n      label: 0,\n      sent: function () {\n        if (t[0] & 1) throw t[1];\n        return t[1];\n      },\n      trys: [],\n      ops: []\n    },\n    f,\n    y,\n    t,\n    g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n        case 7:\n          op = _.ops.pop();\n          _.trys.pop();\n          continue;\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n            _.ops.push(op);\n            break;\n          }\n          if (t[2]) _.ops.pop();\n          _.trys.pop();\n          continue;\n      }\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\nvar __asyncValues = this && this.__asyncValues || function (o) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var m = o[Symbol.asyncIterator],\n    i;\n  return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () {\n    return this;\n  }, i);\n  function verb(n) {\n    i[n] = o[n] && function (v) {\n      return new Promise(function (resolve, reject) {\n        v = o[n](v), settle(resolve, reject, v.done, v.value);\n      });\n    };\n  }\n  function settle(resolve, reject, d, v) {\n    Promise.resolve(v).then(function (v) {\n      resolve({\n        value: v,\n        done: d\n      });\n    }, reject);\n  }\n};\nvar __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar types_1 = require(\"./types\");\nvar resolutionError_1 = __importStar(require(\"./errors/resolutionError\"));\nvar utils_1 = require(\"./utils\");\nvar publicTypes_1 = require(\"./types/publicTypes\");\nvar TwitterSignatureValidator_1 = require(\"./utils/TwitterSignatureValidator\");\nvar FetchProvider_1 = __importDefault(require(\"./FetchProvider\"));\nvar namehash_1 = require(\"./utils/namehash\");\nvar NamingService_1 = require(\"./NamingService\");\nvar configurationError_1 = __importStar(require(\"./errors/configurationError\"));\nvar UnsInternal_1 = __importDefault(require(\"./UnsInternal\"));\nvar Networking_1 = __importDefault(require(\"./utils/Networking\"));\nvar resolver_keys_json_1 = __importDefault(require(\"./config/resolver-keys.json\"));\n/**\n * @internal\n */\nvar Uns = /** @class */function (_super) {\n  __extends(Uns, _super);\n  function Uns(source) {\n    var _this = _super.call(this) || this;\n    _this.name = publicTypes_1.NamingServiceName.UNS;\n    if (source && source.locations && (!source.locations.Layer1 || !source.locations.Layer2)) {\n      throw new configurationError_1.default(configurationError_1.ConfigurationErrorCode.NetworkConfigMissing, {\n        method: publicTypes_1.NamingServiceName.UNS,\n        config: !source.locations.Layer1 ? 'Layer1' : 'Layer2'\n      });\n    }\n    if (!source) {\n      source = {\n        locations: {\n          Layer1: {\n            url: UnsInternal_1.default.UrlMap['mainnet'],\n            network: 'mainnet'\n          },\n          Layer2: {\n            url: UnsInternal_1.default.UrlMap['polygon-mainnet'],\n            network: 'polygon-mainnet'\n          }\n        }\n      };\n    }\n    _this.unsl1 = new UnsInternal_1.default(publicTypes_1.UnsLocation.Layer1, source.locations.Layer1, publicTypes_1.BlockchainType.ETH);\n    _this.unsl2 = new UnsInternal_1.default(publicTypes_1.UnsLocation.Layer2, source.locations.Layer2, publicTypes_1.BlockchainType.MATIC);\n    return _this;\n  }\n  Uns.autoNetwork = function (config) {\n    return __awaiter(this, void 0, void 0, function () {\n      var providerLayer1, providerLayer2, networkIdLayer1, networkIdLayer2, networkNameLayer1, networkNameLayer2;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if ((0, types_1.hasProvider)(config.locations.Layer1) && (0, types_1.hasProvider)(config.locations.Layer2)) {\n              providerLayer1 = config.locations.Layer1.provider;\n              providerLayer2 = config.locations.Layer2.provider;\n            } else {\n              if (!config.locations.Layer1['url'] || !config.locations.Layer2['url']) {\n                throw new configurationError_1.default(configurationError_1.ConfigurationErrorCode.UnspecifiedUrl, {\n                  method: publicTypes_1.NamingServiceName.UNS\n                });\n              }\n              providerLayer1 = FetchProvider_1.default.factory(publicTypes_1.NamingServiceName.UNS, config.locations.Layer1['url']);\n              providerLayer2 = FetchProvider_1.default.factory(publicTypes_1.NamingServiceName.UNS, config.locations.Layer2['url']);\n            }\n            return [4 /*yield*/, providerLayer1.request({\n              method: 'net_version'\n            })];\n          case 1:\n            networkIdLayer1 = _a.sent();\n            return [4 /*yield*/, providerLayer2.request({\n              method: 'net_version'\n            })];\n          case 2:\n            networkIdLayer2 = _a.sent();\n            networkNameLayer1 = utils_1.EthereumNetworksInverted[networkIdLayer1];\n            networkNameLayer2 = utils_1.EthereumNetworksInverted[networkIdLayer2];\n            if (!networkNameLayer1 || !types_1.UnsSupportedNetwork.guard(networkNameLayer1) || !networkNameLayer2 || !types_1.UnsSupportedNetwork.guard(networkNameLayer2)) {\n              throw new configurationError_1.default(configurationError_1.ConfigurationErrorCode.UnsupportedNetwork, {\n                method: publicTypes_1.NamingServiceName.UNS\n              });\n            }\n            return [2 /*return*/, new this({\n              locations: {\n                Layer1: {\n                  network: networkNameLayer1,\n                  provider: providerLayer1\n                },\n                Layer2: {\n                  network: networkNameLayer2,\n                  provider: providerLayer2\n                }\n              }\n            })];\n        }\n      });\n    });\n  };\n  Uns.prototype.namehash = function (domain) {\n    if (!this.checkDomain(domain)) {\n      throw new resolutionError_1.default(resolutionError_1.ResolutionErrorCode.UnsupportedDomain, {\n        domain: domain\n      });\n    }\n    return (0, namehash_1.eip137Namehash)(domain);\n  };\n  Uns.prototype.childhash = function (parentHash, label) {\n    return (0, namehash_1.eip137Childhash)(parentHash, label);\n  };\n  Uns.prototype.isSupportedDomain = function (domain) {\n    return __awaiter(this, void 0, void 0, function () {\n      var tld, _a, existsL1, existsL2;\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            if (!this.checkDomain(domain)) {\n              return [2 /*return*/, false];\n            }\n            tld = domain.split('.').pop();\n            if (!tld) {\n              return [2 /*return*/, false];\n            }\n            return [4 /*yield*/, Promise.all([this.unsl1.exists(tld), this.unsl2.exists(tld)])];\n          case 1:\n            _a = _b.sent(), existsL1 = _a[0], existsL2 = _a[1];\n            return [2 /*return*/, existsL1 || existsL2];\n        }\n      });\n    });\n  };\n  Uns.prototype.owner = function (domain) {\n    return __awaiter(this, void 0, void 0, function () {\n      var tokenId, data;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            tokenId = this.namehash(domain);\n            return [4 /*yield*/, this.get(tokenId, [])];\n          case 1:\n            data = _a.sent();\n            if ((0, utils_1.isNullAddress)(data.owner)) {\n              throw new resolutionError_1.default(resolutionError_1.ResolutionErrorCode.UnregisteredDomain, {\n                domain: domain\n              });\n            }\n            return [2 /*return*/, data.owner];\n        }\n      });\n    });\n  };\n  Uns.prototype.resolver = function (domain) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4 /*yield*/, this.getVerifiedData(domain)];\n          case 1:\n            return [2 /*return*/, _a.sent().resolver];\n        }\n      });\n    });\n  };\n  Uns.prototype.record = function (domain, key) {\n    return __awaiter(this, void 0, void 0, function () {\n      var returnee;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4 /*yield*/, this.records(domain, [key])];\n          case 1:\n            returnee = _a.sent()[key];\n            if (!returnee) {\n              throw new resolutionError_1.default(resolutionError_1.ResolutionErrorCode.RecordNotFound, {\n                recordName: key,\n                domain: domain\n              });\n            }\n            return [2 /*return*/, returnee];\n        }\n      });\n    });\n  };\n  Uns.prototype.records = function (domain, keys) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4 /*yield*/, this.getVerifiedData(domain, keys)];\n          case 1:\n            return [2 /*return*/, _a.sent().records];\n        }\n      });\n    });\n  };\n  Uns.prototype.allRecords = function (domain) {\n    return __awaiter(this, void 0, void 0, function () {\n      var tokenId, metadata;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            tokenId = this.namehash(domain);\n            return [4 /*yield*/, this.getMetadata(tokenId)];\n          case 1:\n            metadata = _a.sent();\n            return [2 /*return*/, this.records(domain, __spreadArray(__spreadArray([], Object.keys(resolver_keys_json_1.default.keys), true), Object.keys(metadata.properties.records), true))];\n        }\n      });\n    });\n  };\n  Uns.prototype.twitter = function (domain) {\n    return __awaiter(this, void 0, void 0, function () {\n      var tokenId, keys, data, records, location, validationSignature, twitterHandle, owner;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            tokenId = this.namehash(domain);\n            keys = ['validation.social.twitter.username', 'social.twitter.username'];\n            return [4 /*yield*/, this.getVerifiedData(domain, keys)];\n          case 1:\n            data = _a.sent();\n            records = data.records, location = data.location;\n            validationSignature = records['validation.social.twitter.username'];\n            twitterHandle = records['social.twitter.username'];\n            if ((0, utils_1.isNullAddress)(validationSignature)) {\n              throw new resolutionError_1.default(resolutionError_1.ResolutionErrorCode.RecordNotFound, {\n                domain: domain,\n                location: location,\n                recordName: 'validation.social.twitter.username'\n              });\n            }\n            if (!twitterHandle) {\n              throw new resolutionError_1.default(resolutionError_1.ResolutionErrorCode.RecordNotFound, {\n                domain: domain,\n                location: location,\n                recordName: 'social.twitter.username'\n              });\n            }\n            owner = data.owner;\n            if (!(0, TwitterSignatureValidator_1.isValidTwitterSignature)({\n              tokenId: tokenId,\n              owner: owner,\n              twitterHandle: twitterHandle,\n              validationSignature: validationSignature\n            })) {\n              throw new resolutionError_1.default(resolutionError_1.ResolutionErrorCode.InvalidTwitterVerification, {\n                domain: domain\n              });\n            }\n            return [2 /*return*/, twitterHandle];\n        }\n      });\n    });\n  };\n  Uns.prototype.reverse = function (address, currencyTicker) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        throw new resolutionError_1.default(resolutionError_1.ResolutionErrorCode.UnsupportedMethod, {\n          methodName: 'reverse'\n        });\n      });\n    });\n  };\n  Uns.prototype.isRegistered = function (domain) {\n    return __awaiter(this, void 0, void 0, function () {\n      var tokenId, data;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            tokenId = this.namehash(domain);\n            return [4 /*yield*/, this.get(tokenId, [])];\n          case 1:\n            data = _a.sent();\n            return [2 /*return*/, !(0, utils_1.isNullAddress)(data.owner)];\n        }\n      });\n    });\n  };\n  Uns.prototype.getTokenUri = function (tokenId) {\n    var e_1, _a;\n    return __awaiter(this, void 0, void 0, function () {\n      var _b, _c, result, tokenUri, e_1_1;\n      var _this = this;\n      return __generator(this, function (_d) {\n        switch (_d.label) {\n          case 0:\n            _d.trys.push([0, 5, 6, 11]);\n            _b = __asyncValues([(0, utils_1.wrapResult)(function () {\n              return _this.unsl2.getTokenUri(tokenId);\n            }), (0, utils_1.wrapResult)(function () {\n              return _this.unsl1.getTokenUri(tokenId);\n            })]);\n            _d.label = 1;\n          case 1:\n            return [4 /*yield*/, _b.next()];\n          case 2:\n            if (!(_c = _d.sent(), !_c.done)) return [3 /*break*/, 4];\n            result = _c.value;\n            tokenUri = (0, utils_1.unwrapResult)(result);\n            if (tokenUri) {\n              return [2 /*return*/, tokenUri];\n            }\n            _d.label = 3;\n          case 3:\n            return [3 /*break*/, 1];\n          case 4:\n            return [3 /*break*/, 11];\n          case 5:\n            e_1_1 = _d.sent();\n            e_1 = {\n              error: e_1_1\n            };\n            return [3 /*break*/, 11];\n          case 6:\n            _d.trys.push([6,, 9, 10]);\n            if (!(_c && !_c.done && (_a = _b.return))) return [3 /*break*/, 8];\n            return [4 /*yield*/, _a.call(_b)];\n          case 7:\n            _d.sent();\n            _d.label = 8;\n          case 8:\n            return [3 /*break*/, 10];\n          case 9:\n            if (e_1) throw e_1.error;\n            return [7 /*endfinally*/];\n          case 10:\n            return [7 /*endfinally*/];\n          case 11:\n            // Note: if a token doesn't exist, ProxyReader returns an empty string. If both responses are empty,\n            // we know for sure that the domain isn't registered.\n            throw new resolutionError_1.default(resolutionError_1.ResolutionErrorCode.UnregisteredDomain, {\n              domain: \"with tokenId \".concat(tokenId)\n            });\n        }\n      });\n    });\n  };\n  Uns.prototype.isAvailable = function (domain) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4 /*yield*/, this.isRegistered(domain)];\n          case 1:\n            return [2 /*return*/, !_a.sent()];\n        }\n      });\n    });\n  };\n  Uns.prototype.registryAddress = function (domainOrNamehash) {\n    return __awaiter(this, void 0, void 0, function () {\n      var _a, resultOrErrorL1, resultOrErrorL2;\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            return [4 /*yield*/, Promise.all([this.unsl1.registryAddress(domainOrNamehash).catch(function (err) {\n              return err;\n            }), this.unsl2.registryAddress(domainOrNamehash).catch(function (err) {\n              return err;\n            })])];\n          case 1:\n            _a = _b.sent(), resultOrErrorL1 = _a[0], resultOrErrorL2 = _a[1];\n            if (resultOrErrorL2 instanceof Error) {\n              validResolutionErrorOrThrow(resultOrErrorL2, resolutionError_1.ResolutionErrorCode.UnregisteredDomain);\n            } else if (!(0, utils_1.isNullAddress)(resultOrErrorL2)) {\n              return [2 /*return*/, resultOrErrorL2];\n            }\n            return [2 /*return*/, validResultOrThrow(resultOrErrorL1)];\n        }\n      });\n    });\n  };\n  Uns.prototype.locations = function (domains) {\n    return __awaiter(this, void 0, void 0, function () {\n      var _a, resultL1, resultL2, nonEmptyRecordsFromL2;\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            return [4 /*yield*/, Promise.all([this.unsl1.locations(domains), this.unsl2.locations(domains)])];\n          case 1:\n            _a = _b.sent(), resultL1 = _a[0], resultL2 = _a[1];\n            nonEmptyRecordsFromL2 = Object.keys(resultL2).filter(function (k) {\n              return resultL2[k] != null;\n            }).reduce(function (a, k) {\n              var _a;\n              return __assign(__assign({}, a), (_a = {}, _a[k] = resultL2[k], _a));\n            }, {});\n            return [2 /*return*/, __assign(__assign({}, resultL1), nonEmptyRecordsFromL2)];\n        }\n      });\n    });\n  };\n  Uns.prototype.reverseOf = function (addr, location) {\n    return __awaiter(this, void 0, void 0, function () {\n      var _a, resultOrErrorL1, resultOrErrorL2, reverseL1, reverseL2, reversedL1, reversedL2;\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            return [4 /*yield*/, Promise.all([this.unsl1.reverseOf(addr).catch(function (err) {\n              return err;\n            }), this.unsl2.reverseOf(addr).catch(function (err) {\n              return err;\n            })])];\n          case 1:\n            _a = _b.sent(), resultOrErrorL1 = _a[0], resultOrErrorL2 = _a[1];\n            reverseL1 = function () {\n              validResultOrThrow(resultOrErrorL1);\n              if (resultOrErrorL1._hex !== '0x00') {\n                return (0, namehash_1.fromHexStringToDecimals)(resultOrErrorL1._hex);\n              } else {\n                return null;\n              }\n            };\n            reverseL2 = function () {\n              validResultOrThrow(resultOrErrorL2);\n              if (resultOrErrorL2._hex !== '0x00') {\n                return (0, namehash_1.fromHexStringToDecimals)(resultOrErrorL2._hex);\n              } else {\n                return null;\n              }\n            };\n            if (location === publicTypes_1.UnsLocation.Layer1) {\n              return [2 /*return*/, reverseL1()];\n            }\n            if (location === publicTypes_1.UnsLocation.Layer2) {\n              return [2 /*return*/, reverseL2()];\n            }\n            reversedL1 = reverseL1();\n            if (reversedL1) {\n              return [2 /*return*/, reversedL1];\n            }\n            reversedL2 = reverseL2();\n            if (reversedL2) {\n              return [2 /*return*/, reversedL2];\n            }\n            return [2 /*return*/, null];\n        }\n      });\n    });\n  };\n  Uns.prototype.getDomainFromTokenId = function (tokenId) {\n    return __awaiter(this, void 0, void 0, function () {\n      var metadata;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4 /*yield*/, this.getMetadata(tokenId)];\n          case 1:\n            metadata = _a.sent();\n            if (this.namehash(metadata.name) !== tokenId) {\n              throw new resolutionError_1.default(resolutionError_1.ResolutionErrorCode.ServiceProviderError, {\n                methodName: 'unhash',\n                domain: metadata.name,\n                providerMessage: 'Service provider returned an invalid domain name'\n              });\n            }\n            return [2 /*return*/, metadata.name];\n        }\n      });\n    });\n  };\n  Uns.prototype.getMetadata = function (tokenId) {\n    return __awaiter(this, void 0, void 0, function () {\n      var tokenUri, resp, metadata;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4 /*yield*/, this.getTokenUri(tokenId)];\n          case 1:\n            tokenUri = _a.sent();\n            return [4 /*yield*/, Networking_1.default.fetch(tokenUri, {}).catch(function (err) {\n              throw new resolutionError_1.default(resolutionError_1.ResolutionErrorCode.MetadataEndpointError, {\n                tokenUri: tokenUri || 'undefined',\n                errorMessage: err.message\n              });\n            })];\n          case 2:\n            resp = _a.sent();\n            if (!resp.ok) {\n              throw new resolutionError_1.default(resolutionError_1.ResolutionErrorCode.MetadataEndpointError, {\n                tokenUri: tokenUri || 'undefined'\n              });\n            }\n            return [4 /*yield*/, resp.json()];\n          case 3:\n            metadata = _a.sent();\n            if (!metadata.name) {\n              throw new resolutionError_1.default(resolutionError_1.ResolutionErrorCode.UnregisteredDomain, {\n                domain: \"with tokenId \".concat(tokenId)\n              });\n            }\n            if (this.namehash(metadata.name) !== tokenId) {\n              throw new resolutionError_1.default(resolutionError_1.ResolutionErrorCode.ServiceProviderError, {\n                methodName: 'unhash',\n                domain: metadata.name,\n                providerMessage: 'Service provider returned an invalid domain name'\n              });\n            }\n            return [2 /*return*/, metadata];\n        }\n      });\n    });\n  };\n  Uns.prototype.getVerifiedData = function (domain, keys) {\n    return __awaiter(this, void 0, void 0, function () {\n      var tokenId, data;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            tokenId = this.namehash(domain);\n            return [4 /*yield*/, this.get(tokenId, keys)];\n          case 1:\n            data = _a.sent();\n            if ((0, utils_1.isNullAddress)(data.resolver)) {\n              if ((0, utils_1.isNullAddress)(data.owner)) {\n                throw new resolutionError_1.default(resolutionError_1.ResolutionErrorCode.UnregisteredDomain, {\n                  domain: domain\n                });\n              }\n              throw new resolutionError_1.default(resolutionError_1.ResolutionErrorCode.UnspecifiedResolver, {\n                location: data.location,\n                domain: domain\n              });\n            }\n            return [2 /*return*/, data];\n        }\n      });\n    });\n  };\n  Uns.prototype.get = function (tokenId, keys) {\n    if (keys === void 0) {\n      keys = [];\n    }\n    return __awaiter(this, void 0, void 0, function () {\n      var _a, resultOrErrorL1, resultOrErrorL2, resolverL2, ownerL2, recordsL2, resolverL1, ownerL1, recordsL1;\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            return [4 /*yield*/, Promise.all([this.unsl1.get(tokenId, keys).catch(function (err) {\n              return err;\n            }), this.unsl2.get(tokenId, keys).catch(function (err) {\n              return err;\n            })])];\n          case 1:\n            _a = _b.sent(), resultOrErrorL1 = _a[0], resultOrErrorL2 = _a[1];\n            validResultOrThrow(resultOrErrorL2);\n            resolverL2 = resultOrErrorL2.resolver, ownerL2 = resultOrErrorL2.owner, recordsL2 = resultOrErrorL2.records;\n            if (!(0, utils_1.isNullAddress)(ownerL2)) {\n              return [2 /*return*/, {\n                resolver: resolverL2,\n                owner: ownerL2,\n                records: (0, utils_1.constructRecords)(keys, recordsL2),\n                location: publicTypes_1.UnsLocation.Layer2\n              }];\n            }\n            validResultOrThrow(resultOrErrorL1);\n            resolverL1 = resultOrErrorL1.resolver, ownerL1 = resultOrErrorL1.owner, recordsL1 = resultOrErrorL1.records;\n            return [2 /*return*/, {\n              resolver: resolverL1,\n              owner: ownerL1,\n              records: (0, utils_1.constructRecords)(keys, recordsL1),\n              location: publicTypes_1.UnsLocation.Layer1\n            }];\n        }\n      });\n    });\n  };\n  Uns.prototype.checkDomain = function (domain, passIfTokenID) {\n    if (passIfTokenID === void 0) {\n      passIfTokenID = false;\n    }\n    if (passIfTokenID) {\n      return true;\n    }\n    var tokens = domain.split('.');\n    return !!tokens.length && !(domain === 'eth' || /^[^-]*[^-]*\\.(eth|luxe|xyz|kred|addr\\.reverse)$/.test(domain)) && tokens.every(function (v) {\n      return !!v.length;\n    });\n  };\n  return Uns;\n}(NamingService_1.NamingService);\nexports.default = Uns;\nfunction validResultOrThrow(resultOrError) {\n  if (resultOrError instanceof Error) {\n    throw resultOrError;\n  }\n  return resultOrError;\n}\nfunction validResolutionErrorOrThrow(error, validCode) {\n  if (!(error instanceof resolutionError_1.default)) {\n    throw error;\n  }\n  if (error.code === validCode) {\n    return true;\n  }\n  throw error;\n}","map":{"version":3,"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","__assign","assign","t","s","i","n","arguments","length","apply","__createBinding","o","m","k","k2","undefined","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","get","defineProperty","__setModuleDefault","v","value","__importStar","mod","result","__awaiter","thisArg","_arguments","P","generator","adopt","resolve","Promise","reject","fulfilled","step","next","e","rejected","done","then","__generator","body","_","label","sent","trys","ops","f","y","g","verb","Symbol","iterator","op","pop","push","__asyncValues","asyncIterator","__values","settle","__spreadArray","to","from","pack","l","ar","slice","concat","__importDefault","exports","types_1","require","resolutionError_1","utils_1","publicTypes_1","TwitterSignatureValidator_1","FetchProvider_1","namehash_1","NamingService_1","configurationError_1","UnsInternal_1","Networking_1","resolver_keys_json_1","Uns","_super","source","_this","name","NamingServiceName","UNS","locations","Layer1","Layer2","default","ConfigurationErrorCode","NetworkConfigMissing","method","config","url","UrlMap","network","unsl1","UnsLocation","BlockchainType","ETH","unsl2","MATIC","autoNetwork","providerLayer1","providerLayer2","networkIdLayer1","networkIdLayer2","networkNameLayer1","networkNameLayer2","_a","hasProvider","provider","UnspecifiedUrl","factory","request","EthereumNetworksInverted","UnsSupportedNetwork","guard","UnsupportedNetwork","namehash","domain","checkDomain","ResolutionErrorCode","UnsupportedDomain","eip137Namehash","childhash","parentHash","eip137Childhash","isSupportedDomain","tld","existsL1","existsL2","_b","split","all","exists","owner","tokenId","data","isNullAddress","UnregisteredDomain","resolver","getVerifiedData","record","key","returnee","records","RecordNotFound","recordName","keys","allRecords","metadata","getMetadata","properties","twitter","location","validationSignature","twitterHandle","isValidTwitterSignature","InvalidTwitterVerification","reverse","address","currencyTicker","UnsupportedMethod","methodName","isRegistered","getTokenUri","e_1","_c","tokenUri","e_1_1","_d","wrapResult","unwrapResult","error","return","isAvailable","registryAddress","domainOrNamehash","resultOrErrorL1","resultOrErrorL2","catch","err","Error","validResolutionErrorOrThrow","validResultOrThrow","domains","resultL1","resultL2","nonEmptyRecordsFromL2","filter","reduce","a","reverseOf","addr","reverseL1","reverseL2","reversedL1","reversedL2","_hex","fromHexStringToDecimals","getDomainFromTokenId","ServiceProviderError","providerMessage","resp","fetch","MetadataEndpointError","errorMessage","message","ok","json","UnspecifiedResolver","resolverL2","ownerL2","recordsL2","resolverL1","ownerL1","recordsL1","constructRecords","passIfTokenID","tokens","test","every","NamingService","resultOrError","validCode","code"],"sources":["/Users/shepher/Downloads/filename-space/node_modules/@unstoppabledomains/resolution/build/Uns.js"],"sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __asyncValues = (this && this.__asyncValues) || function (o) {\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n    var m = o[Symbol.asyncIterator], i;\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar types_1 = require(\"./types\");\nvar resolutionError_1 = __importStar(require(\"./errors/resolutionError\"));\nvar utils_1 = require(\"./utils\");\nvar publicTypes_1 = require(\"./types/publicTypes\");\nvar TwitterSignatureValidator_1 = require(\"./utils/TwitterSignatureValidator\");\nvar FetchProvider_1 = __importDefault(require(\"./FetchProvider\"));\nvar namehash_1 = require(\"./utils/namehash\");\nvar NamingService_1 = require(\"./NamingService\");\nvar configurationError_1 = __importStar(require(\"./errors/configurationError\"));\nvar UnsInternal_1 = __importDefault(require(\"./UnsInternal\"));\nvar Networking_1 = __importDefault(require(\"./utils/Networking\"));\nvar resolver_keys_json_1 = __importDefault(require(\"./config/resolver-keys.json\"));\n/**\n * @internal\n */\nvar Uns = /** @class */ (function (_super) {\n    __extends(Uns, _super);\n    function Uns(source) {\n        var _this = _super.call(this) || this;\n        _this.name = publicTypes_1.NamingServiceName.UNS;\n        if (source &&\n            source.locations &&\n            (!source.locations.Layer1 || !source.locations.Layer2)) {\n            throw new configurationError_1.default(configurationError_1.ConfigurationErrorCode.NetworkConfigMissing, {\n                method: publicTypes_1.NamingServiceName.UNS,\n                config: !source.locations.Layer1 ? 'Layer1' : 'Layer2',\n            });\n        }\n        if (!source) {\n            source = {\n                locations: {\n                    Layer1: {\n                        url: UnsInternal_1.default.UrlMap['mainnet'],\n                        network: 'mainnet',\n                    },\n                    Layer2: {\n                        url: UnsInternal_1.default.UrlMap['polygon-mainnet'],\n                        network: 'polygon-mainnet',\n                    },\n                },\n            };\n        }\n        _this.unsl1 = new UnsInternal_1.default(publicTypes_1.UnsLocation.Layer1, source.locations.Layer1, publicTypes_1.BlockchainType.ETH);\n        _this.unsl2 = new UnsInternal_1.default(publicTypes_1.UnsLocation.Layer2, source.locations.Layer2, publicTypes_1.BlockchainType.MATIC);\n        return _this;\n    }\n    Uns.autoNetwork = function (config) {\n        return __awaiter(this, void 0, void 0, function () {\n            var providerLayer1, providerLayer2, networkIdLayer1, networkIdLayer2, networkNameLayer1, networkNameLayer2;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if ((0, types_1.hasProvider)(config.locations.Layer1) &&\n                            (0, types_1.hasProvider)(config.locations.Layer2)) {\n                            providerLayer1 = config.locations.Layer1.provider;\n                            providerLayer2 = config.locations.Layer2.provider;\n                        }\n                        else {\n                            if (!config.locations.Layer1['url'] || !config.locations.Layer2['url']) {\n                                throw new configurationError_1.default(configurationError_1.ConfigurationErrorCode.UnspecifiedUrl, {\n                                    method: publicTypes_1.NamingServiceName.UNS,\n                                });\n                            }\n                            providerLayer1 = FetchProvider_1.default.factory(publicTypes_1.NamingServiceName.UNS, config.locations.Layer1['url']);\n                            providerLayer2 = FetchProvider_1.default.factory(publicTypes_1.NamingServiceName.UNS, config.locations.Layer2['url']);\n                        }\n                        return [4 /*yield*/, providerLayer1.request({\n                                method: 'net_version',\n                            })];\n                    case 1:\n                        networkIdLayer1 = (_a.sent());\n                        return [4 /*yield*/, providerLayer2.request({\n                                method: 'net_version',\n                            })];\n                    case 2:\n                        networkIdLayer2 = (_a.sent());\n                        networkNameLayer1 = utils_1.EthereumNetworksInverted[networkIdLayer1];\n                        networkNameLayer2 = utils_1.EthereumNetworksInverted[networkIdLayer2];\n                        if (!networkNameLayer1 ||\n                            !types_1.UnsSupportedNetwork.guard(networkNameLayer1) ||\n                            !networkNameLayer2 ||\n                            !types_1.UnsSupportedNetwork.guard(networkNameLayer2)) {\n                            throw new configurationError_1.default(configurationError_1.ConfigurationErrorCode.UnsupportedNetwork, {\n                                method: publicTypes_1.NamingServiceName.UNS,\n                            });\n                        }\n                        return [2 /*return*/, new this({\n                                locations: {\n                                    Layer1: { network: networkNameLayer1, provider: providerLayer1 },\n                                    Layer2: { network: networkNameLayer2, provider: providerLayer2 },\n                                },\n                            })];\n                }\n            });\n        });\n    };\n    Uns.prototype.namehash = function (domain) {\n        if (!this.checkDomain(domain)) {\n            throw new resolutionError_1.default(resolutionError_1.ResolutionErrorCode.UnsupportedDomain, {\n                domain: domain,\n            });\n        }\n        return (0, namehash_1.eip137Namehash)(domain);\n    };\n    Uns.prototype.childhash = function (parentHash, label) {\n        return (0, namehash_1.eip137Childhash)(parentHash, label);\n    };\n    Uns.prototype.isSupportedDomain = function (domain) {\n        return __awaiter(this, void 0, void 0, function () {\n            var tld, _a, existsL1, existsL2;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        if (!this.checkDomain(domain)) {\n                            return [2 /*return*/, false];\n                        }\n                        tld = domain.split('.').pop();\n                        if (!tld) {\n                            return [2 /*return*/, false];\n                        }\n                        return [4 /*yield*/, Promise.all([\n                                this.unsl1.exists(tld),\n                                this.unsl2.exists(tld),\n                            ])];\n                    case 1:\n                        _a = _b.sent(), existsL1 = _a[0], existsL2 = _a[1];\n                        return [2 /*return*/, existsL1 || existsL2];\n                }\n            });\n        });\n    };\n    Uns.prototype.owner = function (domain) {\n        return __awaiter(this, void 0, void 0, function () {\n            var tokenId, data;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        tokenId = this.namehash(domain);\n                        return [4 /*yield*/, this.get(tokenId, [])];\n                    case 1:\n                        data = _a.sent();\n                        if ((0, utils_1.isNullAddress)(data.owner)) {\n                            throw new resolutionError_1.default(resolutionError_1.ResolutionErrorCode.UnregisteredDomain, {\n                                domain: domain,\n                            });\n                        }\n                        return [2 /*return*/, data.owner];\n                }\n            });\n        });\n    };\n    Uns.prototype.resolver = function (domain) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.getVerifiedData(domain)];\n                    case 1: return [2 /*return*/, (_a.sent()).resolver];\n                }\n            });\n        });\n    };\n    Uns.prototype.record = function (domain, key) {\n        return __awaiter(this, void 0, void 0, function () {\n            var returnee;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.records(domain, [key])];\n                    case 1:\n                        returnee = (_a.sent())[key];\n                        if (!returnee) {\n                            throw new resolutionError_1.default(resolutionError_1.ResolutionErrorCode.RecordNotFound, {\n                                recordName: key,\n                                domain: domain,\n                            });\n                        }\n                        return [2 /*return*/, returnee];\n                }\n            });\n        });\n    };\n    Uns.prototype.records = function (domain, keys) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.getVerifiedData(domain, keys)];\n                    case 1: return [2 /*return*/, (_a.sent()).records];\n                }\n            });\n        });\n    };\n    Uns.prototype.allRecords = function (domain) {\n        return __awaiter(this, void 0, void 0, function () {\n            var tokenId, metadata;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        tokenId = this.namehash(domain);\n                        return [4 /*yield*/, this.getMetadata(tokenId)];\n                    case 1:\n                        metadata = _a.sent();\n                        return [2 /*return*/, this.records(domain, __spreadArray(__spreadArray([], Object.keys(resolver_keys_json_1.default.keys), true), Object.keys(metadata.properties.records), true))];\n                }\n            });\n        });\n    };\n    Uns.prototype.twitter = function (domain) {\n        return __awaiter(this, void 0, void 0, function () {\n            var tokenId, keys, data, records, location, validationSignature, twitterHandle, owner;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        tokenId = this.namehash(domain);\n                        keys = [\n                            'validation.social.twitter.username',\n                            'social.twitter.username',\n                        ];\n                        return [4 /*yield*/, this.getVerifiedData(domain, keys)];\n                    case 1:\n                        data = _a.sent();\n                        records = data.records, location = data.location;\n                        validationSignature = records['validation.social.twitter.username'];\n                        twitterHandle = records['social.twitter.username'];\n                        if ((0, utils_1.isNullAddress)(validationSignature)) {\n                            throw new resolutionError_1.default(resolutionError_1.ResolutionErrorCode.RecordNotFound, {\n                                domain: domain,\n                                location: location,\n                                recordName: 'validation.social.twitter.username',\n                            });\n                        }\n                        if (!twitterHandle) {\n                            throw new resolutionError_1.default(resolutionError_1.ResolutionErrorCode.RecordNotFound, {\n                                domain: domain,\n                                location: location,\n                                recordName: 'social.twitter.username',\n                            });\n                        }\n                        owner = data.owner;\n                        if (!(0, TwitterSignatureValidator_1.isValidTwitterSignature)({\n                            tokenId: tokenId,\n                            owner: owner,\n                            twitterHandle: twitterHandle,\n                            validationSignature: validationSignature,\n                        })) {\n                            throw new resolutionError_1.default(resolutionError_1.ResolutionErrorCode.InvalidTwitterVerification, {\n                                domain: domain,\n                            });\n                        }\n                        return [2 /*return*/, twitterHandle];\n                }\n            });\n        });\n    };\n    Uns.prototype.reverse = function (address, currencyTicker) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                throw new resolutionError_1.default(resolutionError_1.ResolutionErrorCode.UnsupportedMethod, {\n                    methodName: 'reverse',\n                });\n            });\n        });\n    };\n    Uns.prototype.isRegistered = function (domain) {\n        return __awaiter(this, void 0, void 0, function () {\n            var tokenId, data;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        tokenId = this.namehash(domain);\n                        return [4 /*yield*/, this.get(tokenId, [])];\n                    case 1:\n                        data = _a.sent();\n                        return [2 /*return*/, !(0, utils_1.isNullAddress)(data.owner)];\n                }\n            });\n        });\n    };\n    Uns.prototype.getTokenUri = function (tokenId) {\n        var e_1, _a;\n        return __awaiter(this, void 0, void 0, function () {\n            var _b, _c, result, tokenUri, e_1_1;\n            var _this = this;\n            return __generator(this, function (_d) {\n                switch (_d.label) {\n                    case 0:\n                        _d.trys.push([0, 5, 6, 11]);\n                        _b = __asyncValues([\n                            (0, utils_1.wrapResult)(function () { return _this.unsl2.getTokenUri(tokenId); }),\n                            (0, utils_1.wrapResult)(function () { return _this.unsl1.getTokenUri(tokenId); }),\n                        ]);\n                        _d.label = 1;\n                    case 1: return [4 /*yield*/, _b.next()];\n                    case 2:\n                        if (!(_c = _d.sent(), !_c.done)) return [3 /*break*/, 4];\n                        result = _c.value;\n                        tokenUri = (0, utils_1.unwrapResult)(result);\n                        if (tokenUri) {\n                            return [2 /*return*/, tokenUri];\n                        }\n                        _d.label = 3;\n                    case 3: return [3 /*break*/, 1];\n                    case 4: return [3 /*break*/, 11];\n                    case 5:\n                        e_1_1 = _d.sent();\n                        e_1 = { error: e_1_1 };\n                        return [3 /*break*/, 11];\n                    case 6:\n                        _d.trys.push([6, , 9, 10]);\n                        if (!(_c && !_c.done && (_a = _b.return))) return [3 /*break*/, 8];\n                        return [4 /*yield*/, _a.call(_b)];\n                    case 7:\n                        _d.sent();\n                        _d.label = 8;\n                    case 8: return [3 /*break*/, 10];\n                    case 9:\n                        if (e_1) throw e_1.error;\n                        return [7 /*endfinally*/];\n                    case 10: return [7 /*endfinally*/];\n                    case 11: \n                    // Note: if a token doesn't exist, ProxyReader returns an empty string. If both responses are empty,\n                    // we know for sure that the domain isn't registered.\n                    throw new resolutionError_1.default(resolutionError_1.ResolutionErrorCode.UnregisteredDomain, {\n                        domain: \"with tokenId \".concat(tokenId),\n                    });\n                }\n            });\n        });\n    };\n    Uns.prototype.isAvailable = function (domain) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.isRegistered(domain)];\n                    case 1: return [2 /*return*/, !(_a.sent())];\n                }\n            });\n        });\n    };\n    Uns.prototype.registryAddress = function (domainOrNamehash) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, resultOrErrorL1, resultOrErrorL2;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, Promise.all([\n                            this.unsl1.registryAddress(domainOrNamehash).catch(function (err) { return err; }),\n                            this.unsl2.registryAddress(domainOrNamehash).catch(function (err) { return err; }),\n                        ])];\n                    case 1:\n                        _a = _b.sent(), resultOrErrorL1 = _a[0], resultOrErrorL2 = _a[1];\n                        if (resultOrErrorL2 instanceof Error) {\n                            validResolutionErrorOrThrow(resultOrErrorL2, resolutionError_1.ResolutionErrorCode.UnregisteredDomain);\n                        }\n                        else if (!(0, utils_1.isNullAddress)(resultOrErrorL2)) {\n                            return [2 /*return*/, resultOrErrorL2];\n                        }\n                        return [2 /*return*/, validResultOrThrow(resultOrErrorL1)];\n                }\n            });\n        });\n    };\n    Uns.prototype.locations = function (domains) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, resultL1, resultL2, nonEmptyRecordsFromL2;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, Promise.all([\n                            this.unsl1.locations(domains),\n                            this.unsl2.locations(domains),\n                        ])];\n                    case 1:\n                        _a = _b.sent(), resultL1 = _a[0], resultL2 = _a[1];\n                        nonEmptyRecordsFromL2 = Object.keys(resultL2)\n                            .filter(function (k) { return resultL2[k] != null; })\n                            .reduce(function (a, k) {\n                            var _a;\n                            return (__assign(__assign({}, a), (_a = {}, _a[k] = resultL2[k], _a)));\n                        }, {});\n                        return [2 /*return*/, __assign(__assign({}, resultL1), nonEmptyRecordsFromL2)];\n                }\n            });\n        });\n    };\n    Uns.prototype.reverseOf = function (addr, location) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, resultOrErrorL1, resultOrErrorL2, reverseL1, reverseL2, reversedL1, reversedL2;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, Promise.all([\n                            this.unsl1.reverseOf(addr).catch(function (err) { return err; }),\n                            this.unsl2.reverseOf(addr).catch(function (err) { return err; }),\n                        ])];\n                    case 1:\n                        _a = _b.sent(), resultOrErrorL1 = _a[0], resultOrErrorL2 = _a[1];\n                        reverseL1 = function () {\n                            validResultOrThrow(resultOrErrorL1);\n                            if (resultOrErrorL1._hex !== '0x00') {\n                                return (0, namehash_1.fromHexStringToDecimals)(resultOrErrorL1._hex);\n                            }\n                            else {\n                                return null;\n                            }\n                        };\n                        reverseL2 = function () {\n                            validResultOrThrow(resultOrErrorL2);\n                            if (resultOrErrorL2._hex !== '0x00') {\n                                return (0, namehash_1.fromHexStringToDecimals)(resultOrErrorL2._hex);\n                            }\n                            else {\n                                return null;\n                            }\n                        };\n                        if (location === publicTypes_1.UnsLocation.Layer1) {\n                            return [2 /*return*/, reverseL1()];\n                        }\n                        if (location === publicTypes_1.UnsLocation.Layer2) {\n                            return [2 /*return*/, reverseL2()];\n                        }\n                        reversedL1 = reverseL1();\n                        if (reversedL1) {\n                            return [2 /*return*/, reversedL1];\n                        }\n                        reversedL2 = reverseL2();\n                        if (reversedL2) {\n                            return [2 /*return*/, reversedL2];\n                        }\n                        return [2 /*return*/, null];\n                }\n            });\n        });\n    };\n    Uns.prototype.getDomainFromTokenId = function (tokenId) {\n        return __awaiter(this, void 0, void 0, function () {\n            var metadata;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.getMetadata(tokenId)];\n                    case 1:\n                        metadata = _a.sent();\n                        if (this.namehash(metadata.name) !== tokenId) {\n                            throw new resolutionError_1.default(resolutionError_1.ResolutionErrorCode.ServiceProviderError, {\n                                methodName: 'unhash',\n                                domain: metadata.name,\n                                providerMessage: 'Service provider returned an invalid domain name',\n                            });\n                        }\n                        return [2 /*return*/, metadata.name];\n                }\n            });\n        });\n    };\n    Uns.prototype.getMetadata = function (tokenId) {\n        return __awaiter(this, void 0, void 0, function () {\n            var tokenUri, resp, metadata;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.getTokenUri(tokenId)];\n                    case 1:\n                        tokenUri = _a.sent();\n                        return [4 /*yield*/, Networking_1.default.fetch(tokenUri, {}).catch(function (err) {\n                                throw new resolutionError_1.default(resolutionError_1.ResolutionErrorCode.MetadataEndpointError, {\n                                    tokenUri: tokenUri || 'undefined',\n                                    errorMessage: err.message,\n                                });\n                            })];\n                    case 2:\n                        resp = _a.sent();\n                        if (!resp.ok) {\n                            throw new resolutionError_1.default(resolutionError_1.ResolutionErrorCode.MetadataEndpointError, {\n                                tokenUri: tokenUri || 'undefined',\n                            });\n                        }\n                        return [4 /*yield*/, resp.json()];\n                    case 3:\n                        metadata = _a.sent();\n                        if (!metadata.name) {\n                            throw new resolutionError_1.default(resolutionError_1.ResolutionErrorCode.UnregisteredDomain, {\n                                domain: \"with tokenId \".concat(tokenId),\n                            });\n                        }\n                        if (this.namehash(metadata.name) !== tokenId) {\n                            throw new resolutionError_1.default(resolutionError_1.ResolutionErrorCode.ServiceProviderError, {\n                                methodName: 'unhash',\n                                domain: metadata.name,\n                                providerMessage: 'Service provider returned an invalid domain name',\n                            });\n                        }\n                        return [2 /*return*/, metadata];\n                }\n            });\n        });\n    };\n    Uns.prototype.getVerifiedData = function (domain, keys) {\n        return __awaiter(this, void 0, void 0, function () {\n            var tokenId, data;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        tokenId = this.namehash(domain);\n                        return [4 /*yield*/, this.get(tokenId, keys)];\n                    case 1:\n                        data = _a.sent();\n                        if ((0, utils_1.isNullAddress)(data.resolver)) {\n                            if ((0, utils_1.isNullAddress)(data.owner)) {\n                                throw new resolutionError_1.default(resolutionError_1.ResolutionErrorCode.UnregisteredDomain, {\n                                    domain: domain,\n                                });\n                            }\n                            throw new resolutionError_1.default(resolutionError_1.ResolutionErrorCode.UnspecifiedResolver, {\n                                location: data.location,\n                                domain: domain,\n                            });\n                        }\n                        return [2 /*return*/, data];\n                }\n            });\n        });\n    };\n    Uns.prototype.get = function (tokenId, keys) {\n        if (keys === void 0) { keys = []; }\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, resultOrErrorL1, resultOrErrorL2, resolverL2, ownerL2, recordsL2, resolverL1, ownerL1, recordsL1;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, Promise.all([\n                            this.unsl1.get(tokenId, keys).catch(function (err) { return err; }),\n                            this.unsl2.get(tokenId, keys).catch(function (err) { return err; }),\n                        ])];\n                    case 1:\n                        _a = _b.sent(), resultOrErrorL1 = _a[0], resultOrErrorL2 = _a[1];\n                        validResultOrThrow(resultOrErrorL2);\n                        resolverL2 = resultOrErrorL2.resolver, ownerL2 = resultOrErrorL2.owner, recordsL2 = resultOrErrorL2.records;\n                        if (!(0, utils_1.isNullAddress)(ownerL2)) {\n                            return [2 /*return*/, {\n                                    resolver: resolverL2,\n                                    owner: ownerL2,\n                                    records: (0, utils_1.constructRecords)(keys, recordsL2),\n                                    location: publicTypes_1.UnsLocation.Layer2,\n                                }];\n                        }\n                        validResultOrThrow(resultOrErrorL1);\n                        resolverL1 = resultOrErrorL1.resolver, ownerL1 = resultOrErrorL1.owner, recordsL1 = resultOrErrorL1.records;\n                        return [2 /*return*/, {\n                                resolver: resolverL1,\n                                owner: ownerL1,\n                                records: (0, utils_1.constructRecords)(keys, recordsL1),\n                                location: publicTypes_1.UnsLocation.Layer1,\n                            }];\n                }\n            });\n        });\n    };\n    Uns.prototype.checkDomain = function (domain, passIfTokenID) {\n        if (passIfTokenID === void 0) { passIfTokenID = false; }\n        if (passIfTokenID) {\n            return true;\n        }\n        var tokens = domain.split('.');\n        return (!!tokens.length &&\n            !(domain === 'eth' ||\n                /^[^-]*[^-]*\\.(eth|luxe|xyz|kred|addr\\.reverse)$/.test(domain)) &&\n            tokens.every(function (v) { return !!v.length; }));\n    };\n    return Uns;\n}(NamingService_1.NamingService));\nexports.default = Uns;\nfunction validResultOrThrow(resultOrError) {\n    if (resultOrError instanceof Error) {\n        throw resultOrError;\n    }\n    return resultOrError;\n}\nfunction validResolutionErrorOrThrow(error, validCode) {\n    if (!(error instanceof resolutionError_1.default)) {\n        throw error;\n    }\n    if (error.code === validCode) {\n        return true;\n    }\n    throw error;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}