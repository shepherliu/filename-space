{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.isValidTwitterSignature = void 0;\nvar index_1 = require(\"./index\");\nvar js_sha3_1 = require(\"js-sha3\");\nvar recoverSignature_1 = require(\"./recoverSignature\");\nvar namehash_1 = require(\"./namehash\");\nvar TwitterVerificationAddress = '0x12cfb13522F13a78b650a8bCbFCf50b7CB899d82';\nvar isValidTwitterSignature = function (_a) {\n  var tokenId = _a.tokenId,\n    owner = _a.owner,\n    twitterHandle = _a.twitterHandle,\n    validationSignature = _a.validationSignature;\n  var tokenIdInDecimals = (0, namehash_1.fromHexStringToDecimals)(tokenId);\n  var message = [tokenIdInDecimals, owner, 'social.twitter.username', twitterHandle].map(function (value) {\n    return '0x' + (0, js_sha3_1.keccak256)(value.startsWith('0x') ? (0, index_1.hexToBytes)(value) : value);\n  }).reduce(function (message, hashedValue) {\n    return message + hashedValue;\n  }, '');\n  var signerAddress = (0, recoverSignature_1.recover)(message, validationSignature);\n  return signerAddress === TwitterVerificationAddress;\n};\nexports.isValidTwitterSignature = isValidTwitterSignature;","map":{"version":3,"names":["Object","defineProperty","exports","value","isValidTwitterSignature","index_1","require","js_sha3_1","recoverSignature_1","namehash_1","TwitterVerificationAddress","_a","tokenId","owner","twitterHandle","validationSignature","tokenIdInDecimals","fromHexStringToDecimals","message","map","keccak256","startsWith","hexToBytes","reduce","hashedValue","signerAddress","recover"],"sources":["/Users/shepher/Downloads/filename-space/node_modules/@unstoppabledomains/resolution/build/utils/TwitterSignatureValidator.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isValidTwitterSignature = void 0;\nvar index_1 = require(\"./index\");\nvar js_sha3_1 = require(\"js-sha3\");\nvar recoverSignature_1 = require(\"./recoverSignature\");\nvar namehash_1 = require(\"./namehash\");\nvar TwitterVerificationAddress = '0x12cfb13522F13a78b650a8bCbFCf50b7CB899d82';\nvar isValidTwitterSignature = function (_a) {\n    var tokenId = _a.tokenId, owner = _a.owner, twitterHandle = _a.twitterHandle, validationSignature = _a.validationSignature;\n    var tokenIdInDecimals = (0, namehash_1.fromHexStringToDecimals)(tokenId);\n    var message = [\n        tokenIdInDecimals,\n        owner,\n        'social.twitter.username',\n        twitterHandle,\n    ]\n        .map(function (value) {\n        return '0x' + (0, js_sha3_1.keccak256)(value.startsWith('0x') ? (0, index_1.hexToBytes)(value) : value);\n    })\n        .reduce(function (message, hashedValue) { return message + hashedValue; }, '');\n    var signerAddress = (0, recoverSignature_1.recover)(message, validationSignature);\n    return signerAddress === TwitterVerificationAddress;\n};\nexports.isValidTwitterSignature = isValidTwitterSignature;\n"],"mappings":"AAAA,YAAY;;AACZA,MAAM,CAACC,cAAc,CAACC,OAAO,EAAE,YAAY,EAAE;EAAEC,KAAK,EAAE;AAAK,CAAC,CAAC;AAC7DD,OAAO,CAACE,uBAAuB,GAAG,KAAK,CAAC;AACxC,IAAIC,OAAO,GAAGC,OAAO,CAAC,SAAS,CAAC;AAChC,IAAIC,SAAS,GAAGD,OAAO,CAAC,SAAS,CAAC;AAClC,IAAIE,kBAAkB,GAAGF,OAAO,CAAC,oBAAoB,CAAC;AACtD,IAAIG,UAAU,GAAGH,OAAO,CAAC,YAAY,CAAC;AACtC,IAAII,0BAA0B,GAAG,4CAA4C;AAC7E,IAAIN,uBAAuB,GAAG,UAAUO,EAAE,EAAE;EACxC,IAAIC,OAAO,GAAGD,EAAE,CAACC,OAAO;IAAEC,KAAK,GAAGF,EAAE,CAACE,KAAK;IAAEC,aAAa,GAAGH,EAAE,CAACG,aAAa;IAAEC,mBAAmB,GAAGJ,EAAE,CAACI,mBAAmB;EAC1H,IAAIC,iBAAiB,GAAG,CAAC,CAAC,EAAEP,UAAU,CAACQ,uBAAuB,EAAEL,OAAO,CAAC;EACxE,IAAIM,OAAO,GAAG,CACVF,iBAAiB,EACjBH,KAAK,EACL,yBAAyB,EACzBC,aAAa,CAChB,CACIK,GAAG,CAAC,UAAUhB,KAAK,EAAE;IACtB,OAAO,IAAI,GAAG,CAAC,CAAC,EAAEI,SAAS,CAACa,SAAS,EAAEjB,KAAK,CAACkB,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,EAAEhB,OAAO,CAACiB,UAAU,EAAEnB,KAAK,CAAC,GAAGA,KAAK,CAAC;EAC3G,CAAC,CAAC,CACGoB,MAAM,CAAC,UAAUL,OAAO,EAAEM,WAAW,EAAE;IAAE,OAAON,OAAO,GAAGM,WAAW;EAAE,CAAC,EAAE,EAAE,CAAC;EAClF,IAAIC,aAAa,GAAG,CAAC,CAAC,EAAEjB,kBAAkB,CAACkB,OAAO,EAAER,OAAO,EAAEH,mBAAmB,CAAC;EACjF,OAAOU,aAAa,KAAKf,0BAA0B;AACvD,CAAC;AACDR,OAAO,CAACE,uBAAuB,GAAGA,uBAAuB"},"metadata":{},"sourceType":"script","externalDependencies":[]}